USER="appfactory"
PASS="thoo_p4Aixau3eit"
DATABASES=""
MYSQL_HOST="appfactory-production.c9bb3mlvskvf.us-east-1.rds.amazonaws.com"

# Drop Existing DBs
for db in api_mgt_registry apimgt jpadb registry rss_dev rss_prod rss_staging rss_test userstore appfactory_config as_dev_config as_prod_config as_test_config as_staging_config ss_dev_config ss_prod_config ss_test_config ss_staging_config api_mgt_config af_bps_config
do 
	mysql -h $MYSQL_HOST -u$USER -p$PASS -Bse "drop database if exists $db"
done

# Create DBs
for db in api_mgt_registry apimgt jpadb registry rss_dev rss_prod rss_staging rss_test userstore appfactory_config as_dev_config as_prod_config as_test_config as_staging_config ss_dev_config ss_prod_config ss_test_config ss_staging_config api_mgt_config af_bps_config
do 
	mysql -h $MYSQL_HOST -u$USER -p$PASS -Bse "create database $db"
done


#Create Users && Grant permission
#for user in apimgt jpadb registry rss_dev rss_prod rss_staging rss_test userstore redmine
#do
#        pass=$user"123"
#        mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on $user.* to $user identified by '$pass'"
#done


#@for db in api_mgt_registry apimgt jpadb registry rss_dev rss_prod rss_staging rss_test userstore
#do
#        mysql -h $MYSQL_HOST -u$USER -p$PASS -Bse "grant all privileges on $db.* to '$USER'@'%'"
#        mysql -h $MYSQL_HOST -u$USER -p$PASS -Bse "flush privileges"
#done
#mysql -h $MYSQL_HOST -u$USER -p$PASS -D mysql -Bse "INSERT INTO user (User,Host,Password) VALUES('apimgt','%',PASSWORD('bae7ia4ua9in8aethahtungae7neeV'))"
#INSERT INTO user  (User,Host,Password) VALUES('apimgt','%',PASSWORD('bae7ia4ua9in8aethahtungae7neeV'));

#mysql -h $MYSQL_HOST -u$USER -p$PASS -D mysql -Bse "INSERT INTO user  (User,Host,Password) VALUES('registry','%',PASSWORD('eesei7oonaiwohh1ieghahsheithuL'));"
#mysql -h $MYSQL_HOST -u$USER -p$PASS -D mysql -Bse "INSERT INTO user  (User,Host,Password) VALUES('userstore','%',PASSWORD('xaiwuaphah5OChaiveQue8ai8lai5u'));"
#mysql -h $MYSQL_HOST -u$USER -p$PASS -D mysql -Bse "INSERT INTO user  (User,Host,Password) VALUES('jpadb','%',PASSWORD('keeW3keiqu5aiKieL2eeT2Aisaigoo'));"






mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on api_mgt_registry.* to apimgt identified by 'bae7ia4ua9in8aethahtungae7neeV'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on registry.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on appfactory_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on as_dev_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on as_prod_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on as_test_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on as_staging_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on ss_dev_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on ss_prod_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on ss_test_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on ss_staging_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on api_mgt_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on af_bps_config.* to registry identified by 'eesei7oonaiwohh1ieghahsheithuL'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on userstore.* to userstore identified by 'xaiwuaphah5OChaiveQue8ai8lai5u'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on jpadb.* to jpadb identified by 'keeW3keiqu5aiKieL2eeT2Aisaigoo'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on redmine.* to admin identified by 'admin'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on redmine.* to redmine identified by 'redmine123'"
mysql -h $MYSQL_HOST -u$USER -p$PASS  -Bse "grant all on s2_foundation.* to s2user identified by 'aht1peisas2ooPheuz4wohSeiVaema'"

#Restore DBs
#apimgt.sql  jpadb.sql  registry.sql  userstore.sql  wso2_rss_mysql.sql
#wso2_rss_mysql.sql
for db in apimgt api_mgt_registry jpadb registry userstore
do
	mysql -h $MYSQL_HOST -u$USER -p$PASS $db < dbscripts/$db.sql
done

#for env in dev staging test prod
for env in dev staging test prod
do
	mysql -h $MYSQL_HOST -u$USER -p$PASS rss_$env < dbscripts/wso2_rss_mysql.sql
done
exit 

